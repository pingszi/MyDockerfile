webpackJsonp([6],{IcnI:function(e,t,n){"use strict";var i,o=n("7+uW"),s=n("NYxO"),r=n("bOdI"),a=n.n(r),u=n("mvHQ"),c=n.n(u),l=n("oAV5"),d=(i={},a()(i,"GETDATAFROMLOCALSTORAGE",function(e,t){e.allMsg=JSON.parse(t)}),a()(i,"ADDQUESTION",function(e,t){e.allMsg[e.allMsg.length-1].msg.push(t),e.isSetSessionStorage&&window.sessionStorage.setItem("allMsg",c()(e.allMsg))}),a()(i,"ADDTOPTENQUESTION",function(e,t){e.topTenQuestion=t}),a()(i,"ADDSESSIONITEM",function(e,t){e.allMsg.push(t)}),a()(i,"CHANGEOUTPUTSCROLLPOSITON",function(e,t){e.outputScrollPosition=t}),a()(i,"CLEARALLMSG",function(e){var t={date:Object(l.b)(),msg:[]};e.allMsg=[t]}),a()(i,"CHANGEFONTSIZE",function(e,t){e.fontSize=t}),a()(i,"CHANGETHEME",function(e,t){e.theme=t}),a()(i,"SETROLE",function(e,t){e.role=t,e.isSetSessionStorage&&window.sessionStorage.setItem("role",t)}),a()(i,"SETUUID",function(e,t){e.uuid=t,e.isSetSessionStorage&&window.sessionStorage.setItem("uuid",t)}),a()(i,"SETISASKED",function(e,t){e.isQuestionAsked=t}),a()(i,"SETISMOBILE",function(e,t){e.isMobile=t}),a()(i,"UNRESOLVETIPSCONTENT",function(e,t){e.unResolveTipsContent=t}),i),f=n("//Fk"),m=n.n(f),g=n("Xxa5"),p=n.n(g),h=n("exGp"),v=n.n(h),S=n("Zx67"),O=n.n(S),w=n("zwoO"),b=n.n(w),E=n("Pf15"),T=n.n(E),A=n("Zrlr"),_=n.n(A),I=n("wxAW"),x=n.n(I),M=n("pFYg"),L=n.n(M),k=n("gyMJ"),N=function(e,t){var n=void 0,i=void 0;if("object"==(void 0===e?"undefined":L()(e))&&(n=e.question.trim(),i=e.id),"string"==typeof e&&(n=e.trim(),i=""),/^\d+$/.test(n)){var o=t.getLatestRelativeQuestion(n);o&&(n=o[0],i=o[1])}return{q:n,qid:i}},Q=function(){function e(t){_()(this,e),this.commit=t,this.msg={host:"",content:{text:"",relativeFileList:null,relativeQuestionList:null,isSetResolve:!1,isLaoshi:!1,time:Object(l.c)(),question:""}}}return x()(e,[{key:"renderMsg",value:function(){this.commit("ADDQUESTION",this.msg),Object(l.e)()}}]),e}(),R=function(e){function t(e,n){_()(this,t);var i=b()(this,(t.__proto__||O()(t)).call(this,e));return i.msg.host="user",i.msg.content.text=n,i.renderMsg(),i}return T()(t,e),t}(Q),q=function(e){function t(e,n){_()(this,t);var i=b()(this,(t.__proto__||O()(t)).call(this,e));return i.msg.host="ai",i.msg.content.text=n,i.renderMsg(),i}return T()(t,e),t}(Q),D=function(e){function t(e,n){_()(this,t);var i=b()(this,(t.__proto__||O()(t)).call(this,e));return i.msg.host="ai",i.msg.content.text="抱歉，您的提问对小穗来说，超纲啦！请在工作时间咨询老师。<br/>如有需要，请联系 QQ：4008861778，或致电源恒热线：400-8861-778。",i.msg.content.isShowSendEmail=!0,i.msg.content.question=n,i.renderMsg(),i}return T()(t,e),t}(Q),P=function(e){function t(e,n){_()(this,t);var i=b()(this,(t.__proto__||O()(t)).call(this,e,n));return i.msg.content.isLaoshi=!0,i.msg.host="ai",i.msg.content.text=n,i.renderMsg(),i}return T()(t,e),t}(Q),y=function(e){function t(e,n){_()(this,t);var i=b()(this,(t.__proto__||O()(t)).call(this,e));return i.msg.host="ai",n.ai_answer.length&&(i.msg.content.text=n.ai_answer[0]),0!==n.ai_policy_answer.length&&(i.msg.content.relativeFileList=n.ai_policy_answer),0!==n.ai_relative_answer.length&&(i.msg.content.relativeQuestionList=n.ai_relative_answer),n.question&&(i.msg.content.question=n.question),i.msg.content.isSetResolve=!0,i.renderMsg(),i}return T()(t,e),t}(Q),U=function(e){function t(e,n){_()(this,t);var i=b()(this,(t.__proto__||O()(t)).call(this,e));return i.msg={isTips:!0,msg:n?"您好，<b>源恒咨询老师</b>很高兴为您解答！":"您好，<b>源恒智能客服小穗</b>很高兴为您服务！"},i.renderMsg(),i}return T()(t,e),t}(Q),j={addTopTenQuestion:function(e){var t=this,n=e.commit;return v()(p.a.mark(function e(){var i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.e)();case 2:i=e.sent,n("ADDTOPTENQUESTION",i.data);case 4:case"end":return e.stop()}},e,t)}))()},askQuestion:function(e,t){var n=this,i=e.state,o=e.commit,s=e.getters;e.dispatch;return v()(p.a.mark(function e(){var r,a,u,c;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=N(t,s),a=r.q,u=r.qid,""!==a){e.next=3;break}return e.abrupt("return",new q(o,"不允许发送空消息。"));case 3:if(i.uuid||!i.isQuestionAsked){e.next=5;break}return e.abrupt("return",new q(o,"输入问题过于频繁,请您休息一会重新输入！"));case 5:return new R(o,a),e.next=8,Object(k.a)({uuid_key:i.uuid,question:a,knowledge_id:u}).catch(function(e){e.response?503===e.response.status&&new q(o,"输入问题过于频繁,请您休息一会重新输入！"):new q(o,"服务器出错了!")});case 8:c=e.sent,i.uuid||o("SETUUID",c.data.uuid_key),c.data.no_result&&c.data.no_policy_result&&c.data.no_relative_result?new D(o,c.data.question):new y(o,c.data);case 11:case"end":return e.stop()}},e,n)}))()},questionResolve:function(e,t){var n=this,i=e.commit;return v()(p.a.mark(function e(){var o;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.f)(t).catch(function(e){new q(i,"服务器出错了!")});case 2:o=e.sent,new q(i,o.data);case 4:case"end":return e.stop()}},e,n)}))()},questionNotResolve:function(e,t){var n=this,i=e.commit;return v()(p.a.mark(function e(){var o;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.g)(t).catch(function(e){new q(i,"服务器出错了!")});case 2:o=e.sent,i("UNRESOLVETIPSCONTENT",o.data);case 4:case"end":return e.stop()}},e,n)}))()},renderQuestionNotResolveTips:function(e){var t=e.state,n=e.commit;new q(n,t.unResolveTipsContent)},clearMsg:function(e){(0,e.commit)("CLEARALLMSG"),sessionStorage.removeItem("allMsg"),Object(l.e)()},sendEmoji:function(e,t){var n=this,i=e.commit;e.getters;return v()(p.a.mark(function e(){var o,s;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return new R(i,"<img src='"+t.src+"' />"),e.next=3,Object(k.c)(t.meanning);case 3:o=e.sent,s=o.data.text,1e5!==o.data.code&&(s="看来我还需要学习来了解更多"),new q(i,s);case 7:case"end":return e.stop()}},e,n)}))()},polling:function(e){var t=this,n=e.commit,i=e.state,o=e.dispatch;return v()(p.a.mark(function e(){var s;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.b)(i.uuid);case 2:s=e.sent,o("switchRole",s.data.role),s.data.answers.length&&s.data.role&&s.data.answers.forEach(function(e){return new P(n,e)});case 5:case"end":return e.stop()}},e,t)}))()},beginPolling:function(e){var t=this,n=e.dispatch,i=e.commit,o=e.state;return v()(p.a.mark(function e(){var s;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.b)(o.uuid);case 2:s=e.sent,i("SETROLE",s.data.role),1===s.data.role&&new P(i,"源恒咨询老师 为您解答。"),setInterval(function(){return n("polling")},3e4);case 6:case"end":return e.stop()}},e,t)}))()},switchRole:function(e,t){var n=e.state,i=e.commit;return new m.a(function(e){t!==n.role&&(i("SETROLE",t),new U(i,1===t?1:0)),e()})},refreshPolling:function(e){var t=this,n=e.dispatch;return v()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:setInterval(function(){return n("polling")},3e4);case 1:case"end":return e.stop()}},e,t)}))()},sendEmail:function(e,t){var n=e.state,i=e.commit;Object(k.h)({uuid_key:n.uuid,question:t.question,email:t.email}).then(function(){new q(i,"发送成功，请等待老师的回复。")}).catch(function(e){new q(i,"发送失败，请重新发送！")})}};o.a.use(s.a);t.a=new s.a.Store({state:{isMobile:!1,fontSize:"13",role:0,isSetSessionStorage:!0,allMsg:[],topTenQuestion:[],outputScrollPosition:0,theme:"grey",uuid:"",isQuestionAsked:!1,unResolveTipsContent:""},getters:{getLatestRelativeQuestion:function(e){return function(t){try{return[e.allMsg.slice(-1)[0].msg.slice(-1)[0].content.relativeQuestionList[t-1].question,e.allMsg.slice(-1)[0].msg.slice(-1)[0].content.relativeQuestionList[t-1].id]}catch(e){return!1}}},getFilefromId:function(e){return function(t){var n={};return e.allMsg.forEach(function(e){e.msg.forEach(function(e){e.content.relativeFileList&&e.content.relativeFileList.forEach(function(e){e.id==t&&(n=e)})})}),n}},getTheme:function(e){return e.theme}},mutations:d,actions:j})},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("7+uW"),o=n("IcnI"),s=n("/ocq");i.a.use(s.a);var r=new s.a({routes:[{path:"/index",name:"AppIndex",component:function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,"THmK"))},meta:{keepAlive:!0}},{path:"/file/:id",name:"AppRelatedPolicies",component:function(){return Promise.all([n.e(0),n.e(3)]).then(n.bind(null,"ciQE"))},meta:{}},{path:"/mIndex",name:"MobleIndex",component:function(){return n.e(4).then(n.bind(null,"Rwo5"))},meta:{keepAlive:!0}},{path:"/mFile/:id",name:"MobileRelatedPolicies",component:function(){return Promise.all([n.e(0),n.e(2)]).then(n.bind(null,"WlGS"))},meta:{}}]}),a=n("oAV5");r.beforeEach(function(e,t,n){"/"===e.path?a.d.versions.mobile?(o.a.commit("SETISMOBILE",!0),n("/mIndex")):n("/index"):a.d.versions.mobile?(o.a.commit("SETISMOBILE",!0),"m"!==e.path.slice(1,2)?n("/m"+e.path.slice(1,2).toUpperCase()+e.path.slice(2)):n()):(o.a.commit("SETISMOBILE",!1),"m"===e.path.slice(1,2)?n("/"+e.path.slice(2,3).toLowerCase()+e.path.slice(3)):n())});var u=n("rifk"),c=n.n(u);n("ZsCP");i.a.directive("focus",{inserted:function(e){e.focus()}}),i.a.filter("deleteEmptyLine",function(e){return e?e=e.toString().replace(/[\n\r]+/g,"\n"):""});var l=n("Dd8w"),d=n.n(l),f=n("NYxO"),m={computed:d()({},Object(f.e)(["allMsg","outputScrollPosition","outputScrollPosition","isSetSessionStorage"])),methods:d()({},Object(f.d)(["GETDATAFROMLOCALSTORAGE","ADDSESSIONITEM","SETUUID","SETROLE","SETISMOBILE"]),Object(f.b)(["refreshPolling"])),created:function(){var e={date:Object(a.b)(),msg:[{host:"ai",content:{text:"您好，源恒智能客服小穗来啦，很高兴为您服务！<br/>希望能给您的疑问提供有效的参考。",relativeFileList:null,relativeQuestionList:null,isSetResolve:!1,time:Object(a.c)()}}]};if(this.isSetSessionStorage){var t=window.sessionStorage.getItem("allMsg"),n=window.sessionStorage.getItem("uuid");n&&(t&&this.GETDATAFROMLOCALSTORAGE(t),this.SETUUID(n))}0!=this.allMsg.length&&this.allMsg[this.allMsg.length-1].date===Object(a.b)()||this.ADDSESSIONITEM(e),window.onresize=this.scrollResize}},g={render:function(){var e=this.$createElement,t=this._self._c||e;return t("keep-alive",{attrs:{include:"AppIndex,AppMobleIndex"}},[t("router-view")],1)},staticRenderFns:[]},p=n("VU/8")(m,g,!1,null,null,null).exports;i.a.use(c.a,{dialog:!0}),i.a.config.productionTip=!1,new i.a({el:"#app",computed:{theme:function(){return"theme-"+this.$store.getters.getTheme}},router:r,store:o.a,components:{App:p},template:'<App :class="theme"/>'})},ZsCP:function(e,t){},gyMJ:function(e,t,n){"use strict";t.e=function(){return o.a.get("/AIQA/v1/hot_question/")},t.g=function(e){return o.a.get("/AIQA/v1/question_unresolve/?question="+e.question+"&uuid_key="+e.uuid)},t.f=function(e){return o.a.get("/AIQA/v1/question_resolve/?question="+e.question+"&uuid_key="+e.uuid)},t.c=function(e){return o()({method:"post",url:"http://www.tuling123.com/openapi/api",params:{key:"bfb9bad7b081450fb1fbfd06bfdb2619",info:e,userid:"253941"}})},t.d=function(e){return o.a.get("/AIQA/v1/get_question/?question="+e)},t.a=function(e){return s.a.commit("SETISASKED",!0),o.a.post("/AIQA/v1/search",{uuid_key:e.uuid_key,question:e.question,knowledge_id:e.knowledge_id,client_type:"PC"})},t.b=function(e){return o.a.post("/AIQA/v1/find_answers",{uuid_key:e})},t.h=function(e){return o.a.post("/AIQA/v1/unsolved_email",{uuid_key:e.uuid_key,question:e.question,email:e.email})};var i=n("mtWM"),o=n.n(i),s=n("IcnI");n("hKoQ").polyfill()},oAV5:function(e,t,n){"use strict";(function(e){t.e=function(){i.a.nextTick(function(){e("#msgOutput").getNiceScroll().resize(),e("#msgOutput").getNiceScroll(0).doScrollTop(e("#msgOutput")[0].scrollHeight,1e3)})},t.f=function(t,n){i.a.nextTick(function(){n?(e("#msgOutput").getNiceScroll().resize(),e("#msgOutput").getNiceScroll(0).doScrollTop(t,1e3)):e("#msgOutput").scrollTop(t)})},t.c=function(){var e=new Date,t=e.getHours()<10?"0"+e.getHours():e.getHours(),n=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),i=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return t+":"+n+":"+i},t.b=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()<10?"0"+(e.getMonth()+1):e.getMonth()+1,i=e.getDate()<10?"0"+e.getDate():e.getDate();return t+"-"+n+"-"+i},t.a=function(t){e(t).niceScroll({cursorcolor:"rgb(22, 120, 163)",cursorwidth:"5px",cursorborder:"none"})},n.d(t,"d",function(){return a});var i=n("7+uW"),o=n("7t+N"),s=(n.n(o),n("qIUf"));n.n(s);var r,a={versions:(r=navigator.userAgent,{trident:r.indexOf("Trident")>-1,presto:r.indexOf("Presto")>-1,webKit:r.indexOf("AppleWebKit")>-1,gecko:r.indexOf("Gecko")>-1&&-1==r.indexOf("KHTML"),mobile:!!r.match(/AppleWebKit.*Mobile.*/)||!!r.match(/AppleWebKit/)&&r.indexOf("QIHU")&&r.indexOf("QIHU")>-1&&r.indexOf("Chrome")<0,ios:!!r.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:r.indexOf("Android")>-1||r.indexOf("Linux")>-1,iPhone:r.indexOf("iPhone")>-1||r.indexOf("Mac")>-1,iPad:r.indexOf("iPad")>-1,webApp:-1==r.indexOf("Safari")})}}).call(t,n("7t+N"))}},["NHnr"]);
//# sourceMappingURL=app.9f2b92ffe2d6aeee9d1a.js.map